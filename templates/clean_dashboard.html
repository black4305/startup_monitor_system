<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ì§€ì›ì‚¬ì—… ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .stat-card { 
            border-radius: 15px; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); 
            transition: transform 0.2s;
        }
        .stat-card:hover { transform: translateY(-2px); }
        .table-container { 
            background: white; 
            border-radius: 10px; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); 
        }
        .refresh-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        .pulse {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <!-- ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ì•Œë¦¼ -->
    <div id="refreshIndicator" class="refresh-indicator" style="display: none;">
        <div class="alert alert-success alert-dismissible">
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            <i class="fas fa-sync-alt"></i> ìƒˆë¡œìš´ ì§€ì›ì‚¬ì—…ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤!
            <button class="btn btn-sm btn-outline-success ms-2" onclick="location.reload()">ìƒˆë¡œê³ ì¹¨</button>
        </div>
    </div>

    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-robot"></i> AI ì§€ì›ì‚¬ì—… ëª¨ë‹ˆí„°ë§
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="/">ëŒ€ì‹œë³´ë“œ</a>
                <a class="nav-link" href="/programs">ì „ì²´ ëª©ë¡</a>
                <button id="refreshBtn" class="btn btn-outline-light btn-sm ms-2" onclick="manualRefresh()">
                    <i class="fas fa-sync-alt"></i> ìƒˆë¡œê³ ì¹¨
                </button>
            </div>
        </div>
    </nav>

    <div class="container mt-4" 
         data-recent-count="{{ programs|length if programs else 0 }}"
         data-last-update="{{ updated or '' }}">
        <!-- ì œëª© -->
        <div class="row mb-4">
            <div class="col-12">
                <h1><i class="fas fa-tachometer-alt text-primary"></i> ëŒ€ì‹œë³´ë“œ</h1>
                <p class="text-muted">
                    ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: <span id="lastUpdate">{{ updated or 'ì •ë³´ì—†ìŒ' }}</span>
                    <span id="dataStatus" class="badge bg-success ms-2">ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§</span>
                </p>
            </div>
        </div>

        <!-- í†µê³„ ì¹´ë“œ -->
        <div class="row mb-4">
            <div class="col-md-3 mb-3">
                <div class="card stat-card bg-primary text-white">
                    <div class="card-body text-center">
                        <i class="fas fa-list fa-3x mb-2"></i>
                        <h3 id="totalPrograms">{{ stats.total_programs or 0 }}</h3>
                        <p class="mb-0">ì´ í”„ë¡œê·¸ë¨</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card stat-card bg-success text-white">
                    <div class="card-body text-center">
                        <i class="fas fa-check-circle fa-3x mb-2"></i>
                        <h3 id="activePrograms">{{ stats.active_programs or 0 }}</h3>
                        <p class="mb-0">í™œì„± í”„ë¡œê·¸ë¨</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card stat-card bg-info text-white">
                    <div class="card-body text-center">
                        <i class="fas fa-brain fa-3x mb-2"></i>
                        <h3 id="deletedPrograms">{{ stats.total_feedback or 0 }}</h3>
                        <p class="mb-0">AI í•™ìŠµ ì™„ë£Œ</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card stat-card bg-warning text-white">
                    <div class="card-body text-center">
                        <i class="fas fa-percentage fa-3x mb-2"></i>
                        <h3 id="accuracyRate">{{ stats.accuracy_percentage or 0 }}%</h3>
                        <p class="mb-0">ì •í™•ë„</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì§€ì›ì‚¬ì—… ê²€ìƒ‰ ì‹œì‘ ë²„íŠ¼ -->
        <div class="row mb-4">
            <div class="col-md-8 mb-3">
                <div class="card stat-card bg-gradient" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <div class="card-body text-center text-white">
                        <h4 class="mb-3">
                            <i class="fas fa-search fa-2x mb-2"></i><br>
                            ì§€ì›ì‚¬ì—… ê²€ìƒ‰
                        </h4>
                        <p class="mb-3">ì „ì²´ 500ê°œ ì‚¬ì´íŠ¸ì—ì„œ ìµœì‹  ì§€ì›ì‚¬ì—…ì„ ê²€ìƒ‰í•©ë‹ˆë‹¤</p>
                        <button id="searchBtn" class="btn btn-light btn-lg px-4" onclick="startSearch()">
                            <i class="fas fa-rocket"></i> ì „ì²´ ê²€ìƒ‰ ì‹œì‘
                        </button>
                        <div id="searchProgress" class="mt-3" style="display: none;">
                            <div class="progress">
                                <div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated" 
                                     role="progressbar" style="width: 0%"></div>
                            </div>
                            <p class="mt-2 mb-0"><span id="progressText">ê²€ìƒ‰ ì¤‘...</span></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ìµœê·¼ í”„ë¡œê·¸ë¨ -->
        <div class="row">
            <div class="col-12">
                <div class="table-container p-4">
                    <h3 class="mb-3">
                        <i class="fas fa-clock text-primary"></i> ìµœê·¼ í”„ë¡œê·¸ë¨ (<span id="recentCount">{{ programs|length if programs else 0 }}</span>ê°œ)
                    </h3>
                    
                    <div id="programsTable">
                        {% if programs %}
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead class="table-light">
                                    <tr>
                                        <th width="40%">ì œëª©</th>
                                        <th width="15%">ì‚¬ì´íŠ¸</th>
                                        <th width="10%">AI ì ìˆ˜</th>
                                        <th width="10%">ë§ˆê°ì¼</th>
                                        <th width="25%">ì•¡ì…˜</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for program in programs %}
                                    <tr id="row-{{ program.external_id or program.id or loop.index }}">
                                        <td>
                                            <strong>{{ (program.title or 'ì œëª©ì—†ìŒ')[:60] }}{% if (program.title or '')|length > 60 %}...{% endif %}</strong>
                                        </td>
                                        <td>
                                            <small class="text-muted">{{ program.organization or program.site_name or 'ì •ë³´ì—†ìŒ' }}</small>
                                        </td>
                                        <td>
                                            <span class="badge bg-info">{{ "%.1f"|format(program.ai_score or 0) }}</span>
                                        </td>
                                        <td>
                                            <small>{{ program.application_deadline or program.deadline or 'ì •ë³´ì—†ìŒ' }}</small>
                                        </td>
                                        <td>
                                            <a href="{{ program.url or '#' }}" target="_blank" class="btn btn-sm btn-outline-success me-1" title="ì›ë³¸ ë³´ê¸°">
                                                <i class="fas fa-external-link-alt"></i>
                                            </a>
                                            <button class="btn btn-sm btn-outline-warning" onclick="deleteProgram('{{ program.external_id or program.id or loop.index }}')" title="AI í•™ìŠµ">
                                                <i class="fas fa-brain"></i> AI í•™ìŠµ
                                            </button>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="text-center mt-3">
                            <a href="/programs" class="btn btn-primary">
                                <i class="fas fa-list"></i> ì „ì²´ ëª©ë¡ ë³´ê¸°
                            </a>
                        </div>
                        {% else %}
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle"></i> ì•„ì§ ìˆ˜ì§‘ëœ í”„ë¡œê·¸ë¨ì´ ì—†ìŠµë‹ˆë‹¤.
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // HTML data ì†ì„±ì—ì„œ ì´ˆê¸°ê°’ ì½ê¸°
        const container = document.querySelector('.container[data-recent-count]');
        let currentProgramCount = parseInt(container.dataset.recentCount) || 0;
        let lastUpdateTime = container.dataset.lastUpdate || "";
        
        // ì‹¤ì‹œê°„ ë°ì´í„° ìƒíƒœ í™•ì¸
        function checkDataStatus() {
            fetch('/api/data_status')
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const newCount = data.total_programs;
                    
                    // ìƒˆë¡œìš´ ë°ì´í„°ê°€ ì¶”ê°€ë˜ì—ˆëŠ”ì§€ í™•ì¸
                    if (newCount > currentProgramCount) {
                        console.log(`ğŸ†• ìƒˆë¡œìš´ ì§€ì›ì‚¬ì—… ë°œê²¬: ${newCount - currentProgramCount}ê°œ`);
                        showRefreshIndicator();
                        updateStats(data);
                        currentProgramCount = newCount;
                    }
                    
                    // ìƒíƒœ ì—…ë°ì´íŠ¸
                    document.getElementById('dataStatus').textContent = 'ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§';
                    document.getElementById('dataStatus').className = 'badge bg-success ms-2';
                }
            })
            .catch(error => {
                console.error('ë°ì´í„° ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:', error);
                document.getElementById('dataStatus').textContent = 'ì—°ê²° ì˜¤ë¥˜';
                document.getElementById('dataStatus').className = 'badge bg-danger ms-2';
            });
        }
        
        // ìƒˆë¡œê³ ì¹¨ ì•Œë¦¼ í‘œì‹œ
        function showRefreshIndicator() {
            const indicator = document.getElementById('refreshIndicator');
            indicator.style.display = 'block';
            indicator.classList.add('pulse');
        }
        
        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats(data) {
            document.getElementById('totalPrograms').textContent = data.total_programs;
            document.getElementById('activePrograms').textContent = data.total_programs;
            document.getElementById('recentCount').textContent = Math.min(10, data.total_programs);
            
            // ì¹´ë“œì— ìƒˆë¡œìš´ ë°ì´í„° ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€
            const cards = document.querySelectorAll('.stat-card');
            cards.forEach(card => {
                card.classList.add('pulse');
                setTimeout(() => card.classList.remove('pulse'), 2000);
            });
        }
        
        // ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨
        function manualRefresh() {
            const btn = document.getElementById('refreshBtn');
            const originalHtml = btn.innerHTML;
            
            btn.innerHTML = '<i class="fas fa-sync-alt fa-spin"></i> ìƒˆë¡œê³ ì¹¨ ì¤‘...';
            btn.disabled = true;
            
            fetch('/api/refresh_data', { method: 'POST' })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    setTimeout(() => location.reload(), 500);
                } else {
                    alert('ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨: ' + data.error);
                }
            })
            .catch(error => {
                console.error('ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨:', error);
                alert('ìƒˆë¡œê³ ì¹¨ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            })
            .finally(() => {
                btn.innerHTML = originalHtml;
                btn.disabled = false;
            });
        }
        
        // 30ì´ˆë§ˆë‹¤ ë°ì´í„° ìƒíƒœ í™•ì¸
        setInterval(checkDataStatus, 30000);
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì¦‰ì‹œ í™•ì¸
        setTimeout(checkDataStatus, 2000);

        function deleteProgram(programId) {
            if (confirm('ì´ í”„ë¡œê·¸ë¨ì„ AI í•™ìŠµ ë°ì´í„°ë¡œ ì‚¬ìš©í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                fetch(`/api/delete/${programId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        document.getElementById(`row-${programId}`).style.display = 'none';
                        alert(data.message || 'AIê°€ í•™ìŠµí–ˆìŠµë‹ˆë‹¤.');
                        // í”„ë¡œê·¸ë¨ ìˆ˜ ì—…ë°ì´íŠ¸
                        currentProgramCount--;
                        document.getElementById('recentCount').textContent = Math.max(0, currentProgramCount);
                    } else {
                        alert('AI í•™ìŠµ ì‹¤íŒ¨: ' + (data.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('AI í•™ìŠµ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                });
            }
        }

        function startSearch() {
            const searchBtn = document.getElementById('searchBtn');
            const searchProgress = document.getElementById('searchProgress');
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            
            // ë²„íŠ¼ ë¹„í™œì„±í™” ë° ì§„í–‰ ìƒíƒœ í‘œì‹œ
            searchBtn.disabled = true;
            searchBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ê²€ìƒ‰ ì¤‘...';
            searchProgress.style.display = 'block';
            progressText.textContent = 'ê²€ìƒ‰ ìš”ì²­ì„ ë³´ë‚´ëŠ” ì¤‘...';
            progressBar.style.width = '5%';
            
            // AI í¬ë¡¤ëŸ¬ ì‹¤í–‰ ìš”ì²­
            fetch('/api/start_search', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ full_search: true })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    progressText.textContent = 'ê²€ìƒ‰ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. ì§„í–‰ ìƒí™©ì„ í™•ì¸ ì¤‘...';
                    
                    // ì§„í–‰ ìƒí™© í´ë§ ì‹œì‘
                    checkSearchProgress();
                } else {
                    alert('ê²€ìƒ‰ ì‹œì‘ ì‹¤íŒ¨: ' + (data.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                    resetSearchButton();
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('ê²€ìƒ‰ ì‹œì‘ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                resetSearchButton();
            });
        }
        
        function checkSearchProgress() {
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            
            fetch('/api/search_progress')
            .then(response => response.json())
            .then(data => {
                if (data.success && data.progress) {
                    const progress = data.progress;
                    const percentage = progress.progress_percentage || 0;
                    
                    progressBar.style.width = percentage + '%';
                    progressText.textContent = `ê²€ìƒ‰ ì§„í–‰ë¥ : ${percentage.toFixed(1)}% (${progress.completed_sites || 0}/${progress.total_sites || 0} ì‚¬ì´íŠ¸ ì™„ë£Œ)`;
                    
                    if (percentage >= 100) {
                        progressText.textContent = 'ê²€ìƒ‰ ì™„ë£Œ! ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ í™•ì¸ ì¤‘...';
                        setTimeout(() => {
                            // ê²€ìƒ‰ ì™„ë£Œ í›„ ë°ì´í„° í™•ì¸
                            checkDataStatus();
                            location.reload();
                        }, 3000);
                    } else {
                        // 5ì´ˆ í›„ ë‹¤ì‹œ í™•ì¸
                        setTimeout(checkSearchProgress, 5000);
                    }
                } else {
                    // ì—ëŸ¬ ë°œìƒ ì‹œ 5ì´ˆ í›„ ë‹¤ì‹œ ì‹œë„
                    setTimeout(checkSearchProgress, 5000);
                }
            })
            .catch(error => {
                console.error('Progress check error:', error);
                // ì—ëŸ¬ ë°œìƒ ì‹œ 5ì´ˆ í›„ ë‹¤ì‹œ ì‹œë„
                setTimeout(checkSearchProgress, 5000);
            });
        }
        
        function resetSearchButton() {
            const searchBtn = document.getElementById('searchBtn');
            const searchProgress = document.getElementById('searchProgress');
            
            searchBtn.disabled = false;
            searchBtn.innerHTML = '<i class="fas fa-rocket"></i> ì „ì²´ ê²€ìƒ‰ ì‹œì‘';
            searchProgress.style.display = 'none';
        }
        
        // ê°•í™”í•™ìŠµ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function checkRLStatus() {
            const statusBtn = document.getElementById('rlStatusBtn');
            const statusDiv = document.getElementById('rlStatus');
            
            statusBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> í™•ì¸ ì¤‘...';
            statusBtn.disabled = true;
            
            fetch('/api/reinforcement_learning/status')
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const rl = data.reinforcement_learning;
                    let statusHtml = '';
                    
                    if (rl.rl_available) {
                        statusHtml = `
                            <p class="mb-1"><small><i class="fas fa-check-circle text-success"></i> ê°•í™”í•™ìŠµ í™œì„±í™”</small></p>
                            <p class="mb-1"><small>ëŒ€ê¸° ì¤‘: ${rl.feedback_queue_size || 0}ê°œ</small></p>
                            <p class="mb-1"><small>ì„ê³„ê°’: ${rl.min_feedback_threshold || 5}ê°œ</small></p>
                        `;
                        
                        if (rl.ready_for_rl) {
                            statusHtml += '<p class="mb-0"><small><i class="fas fa-fire text-warning"></i> í•™ìŠµ ì¤€ë¹„ë¨!</small></p>';
                        } else {
                            statusHtml += '<p class="mb-0"><small><i class="fas fa-clock text-info"></i> í”¼ë“œë°± ìˆ˜ì§‘ ì¤‘</small></p>';
                        }
                    } else {
                        statusHtml = `
                            <p class="mb-1"><small><i class="fas fa-times-circle text-danger"></i> ê°•í™”í•™ìŠµ ë¹„í™œì„±í™”</small></p>
                            <p class="mb-0"><small>ì˜ì¡´ì„± ì„¤ì¹˜ í•„ìš”</small></p>
                        `;
                    }
                    
                    statusDiv.innerHTML = statusHtml;
                } else {
                    statusDiv.innerHTML = '<p class="mb-0"><small><i class="fas fa-exclamation-triangle text-warning"></i> ìƒíƒœ í™•ì¸ ì‹¤íŒ¨</small></p>';
                }
            })
            .catch(error => {
                console.error('ê°•í™”í•™ìŠµ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:', error);
                statusDiv.innerHTML = '<p class="mb-0"><small><i class="fas fa-exclamation-triangle text-danger"></i> ì—°ê²° ì˜¤ë¥˜</small></p>';
            })
            .finally(() => {
                statusBtn.innerHTML = '<i class="fas fa-chart-line"></i> ìƒíƒœ í™•ì¸';
                statusBtn.disabled = false;
            });
        }
        
        function forceRLOptimization() {
            const forceBtn = document.getElementById('forceRLBtn');
            const statusDiv = document.getElementById('rlStatus');
            
            if (!confirm('ê°•í™”í•™ìŠµ ìµœì í™”ë¥¼ ê°•ì œë¡œ ì‹¤í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\ní˜„ì¬ê¹Œì§€ì˜ í”¼ë“œë°± ë°ì´í„°ë¡œ AIë¥¼ í•™ìŠµì‹œí‚µë‹ˆë‹¤.')) {
                return;
            }
            
            forceBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ìµœì í™” ì¤‘...';
            forceBtn.disabled = true;
            
            statusDiv.innerHTML = '<p class="mb-0"><small><i class="fas fa-cogs fa-spin text-warning"></i> ê°•í™”í•™ìŠµ ì‹¤í–‰ ì¤‘...</small></p>';
            
            fetch('/api/reinforcement_learning/optimize', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    statusDiv.innerHTML = '<p class="mb-0"><small><i class="fas fa-check-circle text-success"></i> ìµœì í™” ì‹œì‘ë¨!</small></p>';
                    alert('ê°•í™”í•™ìŠµ ìµœì í™”ê°€ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.\nAIê°€ í”¼ë“œë°±ì„ ë°”íƒ•ìœ¼ë¡œ í•™ìŠµí•˜ê³  ìˆìŠµë‹ˆë‹¤.');
                    
                    // 5ì´ˆ í›„ ìƒíƒœ ë‹¤ì‹œ í™•ì¸
                    setTimeout(checkRLStatus, 5000);
                } else {
                    statusDiv.innerHTML = '<p class="mb-0"><small><i class="fas fa-exclamation-triangle text-danger"></i> ìµœì í™” ì‹¤íŒ¨</small></p>';
                    alert('ê°•í™”í•™ìŠµ ìµœì í™” ì‹¤íŒ¨: ' + (data.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                }
            })
            .catch(error => {
                console.error('ê°•í™”í•™ìŠµ ìµœì í™” ì‹¤íŒ¨:', error);
                statusDiv.innerHTML = '<p class="mb-0"><small><i class="fas fa-exclamation-triangle text-danger"></i> ì—°ê²° ì˜¤ë¥˜</small></p>';
                alert('ê°•í™”í•™ìŠµ ìµœì í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            })
            .finally(() => {
                forceBtn.innerHTML = '<i class="fas fa-cogs"></i> ê°•ì œ ìµœì í™”';
                forceBtn.disabled = false;
            });
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê°•í™”í•™ìŠµ ìƒíƒœ í™•ì¸
        setTimeout(checkRLStatus, 3000);
        
        // 30ì´ˆë§ˆë‹¤ ê°•í™”í•™ìŠµ ìƒíƒœ í™•ì¸
        setInterval(checkRLStatus, 30000);
    </script>
</body>
</html> 